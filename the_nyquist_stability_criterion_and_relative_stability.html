<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.552">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>principles-of-automatic-controls - The Nyquist Stability Criterion and Relative Stability</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="styles.css">
<meta property="og:title" content="principles-of-automatic-controls - The Nyquist Stability Criterion and Relative Stability">
<meta property="og:description" content="Course in feedback control for the University of Pisa">
<meta property="og:site_name" content="principles-of-automatic-controls">
<meta name="twitter:title" content="principles-of-automatic-controls - The Nyquist Stability Criterion and Relative Stability">
<meta name="twitter:description" content="Course in feedback control for the University of Pisa">
<meta name="twitter:card" content="summary">
</head>

<body class="nav-sidebar floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">principles-of-automatic-controls</span>
    </a>
  </div>
        <div class="quarto-navbar-tools tools-end">
</div>
          <div id="quarto-search" class="" title="Search"></div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./the_nyquist_stability_criterion_and_relative_stability.html">The Nyquist Stability Criterion and Relative Stability</a></li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Feedback Control</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./faq.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Frequently Asked Questions (FAQ)</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./syllabus.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Syllabus for “Principles of Automatic Control”</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./toc.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Table of Contents</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./update_and_manage_local_changes_guide.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">A Guide to Updating Your Local Repository with Git in Anaconda’s Virtual Environment</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./getting_started_with_python_and_jupyter_notebook.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Getting Started with Python and Jupyter Notebooks</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Principles of Automatic Control</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./basics_of_feedback_control.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction to Feedback Control Systems</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./introduction_to_control_problem.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction to the control problem</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./dynamic_systems.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Modeling in Control Systems</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./dynamic_response.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Dynamic response of control systems</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./06_inverse_laplace_transform.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Inverse Laplace Transform: Partial fraction decomposition</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./modeling_dynamic_systems.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction to Modeling of Dynamic Systems</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./control_system_components.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Control System Components</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./models_of_control_devices_and_systems.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Models of Controlled Devices</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./hardware_and_case_studies.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Hardware of Control Systems and Case Studies</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ac_hardware_and_case_studies.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">AC Motion Control Systems</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./a_first_complete_application.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">A Feedback Control System</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./principles_of_feedback_control.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Principles of Feedback Control</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./feedback_systems_and_their_effects.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Feedback systems and their effects</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./introduction_to_control_systems.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction to Control Systems</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stability.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Stability Analysis in Control Systems</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stability_and_routh_criterion.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Stability Analysis in Control Systems</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./performance_of_feedback_systems.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Performance of Feedback Systems</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./design_of_feedback_control.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Design Cycle for a Standard Second-Order System</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./20_Design_of_feedback_control_continued.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Understanding the Standard Second-Order System: Recap</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./steady_state_accuracy_and_design_principles.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Steady State Accuracy and Design Principles</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./compensator_design_using_root_locus.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Compensator Design</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./design_with_the_root_locus.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Design with the Root Locus</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./compensators_and_root_locus.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Compensators and the Root Locus</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./introduction_to_frequency_domain_analysis_in_control_systems.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction to Frequency Domain Analysis in Control Systems</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./application_of_nyquist_stability_criterion.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Application of Nyquist Stability Criterion in Control Systems</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./the_nyquist_stability_criterion_and_relative_stability.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">The Nyquist Stability Criterion and Relative Stability</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./bode_plots.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Bode Plot Analysis</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./feedback_system_performance_based_on_frequency_response.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Feedback System Performance Based On Frequency Response</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./compensator_design_using_frequency_response_plots.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Principles of Automatic Control: Lead and Lag Compensation</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
 <span class="menu-text">IT_TCLab_🇮🇹</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./IT_TCLab_🇮🇹/spacecraft_thermal_control_systems_it.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Il Laboratorio di Controllo della Temperatura</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./IT_TCLab_🇮🇹/tclab_exercises_report_template_it.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Modello di report sugli esercizi TCLab</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./IT_TCLab_🇮🇹/tclab_it.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Il Laboratorio di Controllo della Temperatura</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./IT_TCLab_🇮🇹/understanding_tclab_it.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Comprendere TCLab</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./IT_TCLab_🇮🇹/tclab_lab_1_coding_a_relay_controller_it.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">TCLab Lab 1: Codifica di un controller relè</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./IT_TCLab_🇮🇹/system_model_and_identification_tclab_it.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Modellazione del sistema</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./IT_TCLab_🇮🇹/step_testing_tclab_it.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Passo Test</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./IT_TCLab_🇮🇹/fitting_step_test_data_to_empirical_models_it.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Adattamento dei dati dei test di fase ai modelli empirici</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./IT_TCLab_🇮🇹/tclab_lab_2_model_identification_it.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">TCLab Lab 2: Identificazione del modello</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./IT_TCLab_🇮🇹/tclab_lab_2_fitting_it.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Identificazione del modello: adattamento dei modelli ai dati</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./IT_TCLab_🇮🇹/relay_control_it.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Controllo relè</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./IT_TCLab_🇮🇹/pid_control_it.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Controllo PID</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./IT_TCLab_🇮🇹/lab-assignment-pid-control_it.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Compito di laboratorio: Controllo PID</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./IT_TCLab_🇮🇹/lab-assignment-pi-control_it.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Compito di laboratorio 4: Controllo PI</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
 <span class="menu-text">IT_🇮🇹</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./IT_🇮🇹/faq_it.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Domande frequenti (FAQ)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./IT_🇮🇹/syllabus_it.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Programma del corso “Principi del controllo automatico”</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./IT_🇮🇹/update_and_manage_local_changes_guide_it.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Aggiornare il Proprio Repository Locale Mantenendo le Modifiche Locali</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./IT_🇮🇹/getting_started_with_python_and_jupyter_notebook_it.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Guida introduttiva ai notebook Python e Jupyter</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./IT_🇮🇹/intro_it.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Principi di controllo automatico</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./IT_🇮🇹/basics_of_feedback_control_it.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduzione ai sistemi di controllo del feedback</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./IT_🇮🇹/introduction_to_control_problem_it.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduzione al problema del controllo</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./IT_🇮🇹/dynamic_systems_it.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Modellazione nei sistemi di controllo</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./IT_🇮🇹/dynamic_response_it.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Risposta dinamica dei sistemi di controllo</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./IT_🇮🇹/06_inverse_laplace_transform_it.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Trasformata di Laplace inversa: scomposizione parziale di frazioni</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./IT_🇮🇹/modeling_dynamic_systems_it.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduzione alla modellazione dei sistemi dinamici</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./IT_🇮🇹/control_system_components_it.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Componenti del sistema di controllo</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./IT_🇮🇹/models_of_control_devices_and_systems_it.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Modelli di dispositivi controllati</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./IT_🇮🇹/hardware_and_case_studies_it.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Hardware dei sistemi di controllo e casi di studio</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./IT_🇮🇹/ac_hardware_and_case_studies_it.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Sistemi di controllo del movimento CA</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./IT_🇮🇹/a_first_complete_application_it.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Un sistema di controllo del feedback</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./IT_🇮🇹/principles_of_feedback_control_it.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Principi di controllo del feedback</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./IT_🇮🇹/feedback_systems_and_their_effects_it.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Sistemi di feedback e loro effetti</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./IT_🇮🇹/introduction_to_control_systems_it.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduzione ai sistemi di controllo</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./IT_🇮🇹/stability_it.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Analisi di stabilità nei sistemi di controllo</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./IT_🇮🇹/stability_and_routh_criterion_it.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Analisi di stabilità nei sistemi di controllo</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./IT_🇮🇹/performance_of_feedback_systems_it.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Prestazioni dei sistemi di feedback</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./IT_🇮🇹/design_of_feedback_control_it.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Ciclo di progettazione per un sistema standard del secondo ordine</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./IT_🇮🇹/20_Design_of_feedback_control_continued_it.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Comprensione del sistema standard del secondo ordine: riepilogo</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./IT_🇮🇹/steady_state_accuracy_and_design_principles_it.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Precisione dello stato stazionario e principi di progettazione</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./IT_🇮🇹/compensator_design_using_root_locus_it.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Progettazione del compensatore</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./IT_🇮🇹/design_with_the_root_locus_it.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Progettare con il luogo delle radici</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./IT_🇮🇹/compensators_and_root_locus_it.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Compensatori e luogo delle radici</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./IT_🇮🇹/introduction_to_frequency_domain_analysis_in_control_systems_it.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduzione all’analisi nel dominio della frequenza nei sistemi di controllo</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./IT_🇮🇹/application_of_nyquist_stability_criterion_it.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Applicazione del criterio di stabilità di Nyquist nei sistemi di controllo</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./IT_🇮🇹/the_nyquist_stability_criterion_and_relative_stability_it.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Il criterio di stabilità di Nyquist e la stabilità relativa</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./IT_🇮🇹/bode_plots_it.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Analisi del diagramma di Bode</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./IT_🇮🇹/feedback_system_performance_based_on_frequency_response_it.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Prestazioni del sistema di feedback basate sulla risposta in frequenza</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./IT_🇮🇹/index_it.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Syllabus - Fondamenti di Automatica</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">
 <span class="menu-text">TCLab</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./TCLab/spacecraft_thermal_control_systems.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">The Temperature Control Laboratory</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./TCLab/tclab_exercises_report_template.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">TCLab Exercises Report Template</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./TCLab/tclab.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">The Temperature Control Lab</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./TCLab/understanding_tclab.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Understanding TCLab</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./TCLab/tclab_lab_1_coding_a_relay_controller-solution.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">TCLab Lab 1: Coding a relay controller</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./TCLab/tclab_lab_1_coding_a_relay_controller.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">TCLab Lab 1: Coding a relay controller</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./TCLab/system_model_and_identification_tclab.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">System Modeling</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./TCLab/step_testing_tclab.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Step Testing</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./TCLab/fitting_step_test_data_to_empirical_models.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Fitting Step Test Data to Empirical Models</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./TCLab/tclab_lab_2_model_identification.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">TCLab Lab 2: Model Identification</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./TCLab/tclab_lab_2_model_identification_solutions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">TCLab Lab 2: Model Identification</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./TCLab/tclab_lab_2_fitting.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Model Identification: Fitting models to data</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./TCLab/relay_control.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Relay Control</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./TCLab/pid_control.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">PID Control</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./TCLab/lab-assignment-pid-control.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lab Assignment: PID Control</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./TCLab/lab-assignment-pi-control.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lab Assignment 4: PI Control</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#introduction-to-relative-stability" id="toc-introduction-to-relative-stability" class="nav-link active" data-scroll-target="#introduction-to-relative-stability">Introduction to Relative Stability</a>
  <ul class="collapse">
  <li><a href="#transitioning-to-frequency-domain" id="toc-transitioning-to-frequency-domain" class="nav-link" data-scroll-target="#transitioning-to-frequency-domain">Transitioning to Frequency Domain</a></li>
  <li><a href="#interpreting-nyquist-plots-for-relative-stability" id="toc-interpreting-nyquist-plots-for-relative-stability" class="nav-link" data-scroll-target="#interpreting-nyquist-plots-for-relative-stability">Interpreting Nyquist Plots for Relative Stability</a></li>
  <li><a href="#gain-and-phase-margins" id="toc-gain-and-phase-margins" class="nav-link" data-scroll-target="#gain-and-phase-margins">Gain and Phase Margins</a></li>
  </ul></li>
  <li><a href="#infinite-gain-margin" id="toc-infinite-gain-margin" class="nav-link" data-scroll-target="#infinite-gain-margin">Infinite Gain Margin</a>
  <ul class="collapse">
  <li><a href="#understanding-gain-and-phase-margins-in-open-loop-stable-systems" id="toc-understanding-gain-and-phase-margins-in-open-loop-stable-systems" class="nav-link" data-scroll-target="#understanding-gain-and-phase-margins-in-open-loop-stable-systems">Understanding Gain and Phase Margins in Open-Loop Stable Systems</a></li>
  <li><a href="#type-0-systems" id="toc-type-0-systems" class="nav-link" data-scroll-target="#type-0-systems">Type-0 Systems</a></li>
  </ul></li>
  <li><a href="#addressing-open-loop-unstable-systems" id="toc-addressing-open-loop-unstable-systems" class="nav-link" data-scroll-target="#addressing-open-loop-unstable-systems">Addressing Open-Loop Unstable Systems</a></li>
  <li><a href="#understanding-crossover-frequencies" id="toc-understanding-crossover-frequencies" class="nav-link" data-scroll-target="#understanding-crossover-frequencies">Understanding Crossover Frequencies</a>
  <ul class="collapse">
  <li><a href="#clarifying-gain-and-phase-margins-in-control-systems" id="toc-clarifying-gain-and-phase-margins-in-control-systems" class="nav-link" data-scroll-target="#clarifying-gain-and-phase-margins-in-control-systems">Clarifying Gain and Phase Margins in Control Systems</a></li>
  </ul></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/andreamunafo/principles-of-automatic-controls/issues/new" class="toc-action"><i class="bi bi-github"></i>Report an issue</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">The Nyquist Stability Criterion and Relative Stability</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<!-- WARNING: THIS FILE WAS AUTOGENERATED! DO NOT EDIT! -->
<section id="introduction-to-relative-stability" class="level2">
<h2 class="anchored" data-anchor-id="introduction-to-relative-stability">Introduction to Relative Stability</h2>
<p>Relative stability refers to the degree to which a system tolerates changes in its parameters before becoming unstable. Unlike absolute stability, which simply tells us whether a system is stable or not, relative stability provides a measure of how close the system is to the boundary of instability.</p>
<p>Consider a plot representing the closed-loop poles on the sigma-jω (σ-jω) plane. Suppose we have two dominant poles in this system. If these poles are closer to the jω axis, the transient response of the system decays faster.</p>
<p>This positioning of the poles relative to the jω axis indicates the system’s relative stability.</p>
<p>The real part guides the envelope of the oscillating response.</p>
<table>
<tbody><tr>
<td>
<img src="./pics/27_The_Nyquist_Stability_Criterion_and_Relative_Stability_1.png" alt="27_The_Nyquist_Stability_Criterion_and_Relative_Stability_1" style="width:550px;">
</td>
</tr>
</tbody></table>
<section id="key-concept-dominant-poles-and-transient-response" class="level4">
<h4 class="anchored" data-anchor-id="key-concept-dominant-poles-and-transient-response">Key Concept: Dominant Poles and Transient Response</h4>
<ul>
<li>Dominant poles are those which have the most significant effect on the system’s behavior.</li>
<li>The closer these poles are to the jω axis, the slower the transient response decays, indicating poorer relative stability.</li>
</ul>
</section>
<section id="transitioning-to-frequency-domain" class="level3">
<h3 class="anchored" data-anchor-id="transitioning-to-frequency-domain">Transitioning to Frequency Domain</h3>
<p>Now, let’s interpret these concepts in the frequency domain using the Nyquist plot.</p>
<p>The plots corresponding to the previous s-plane example might be as below (note that this is only an example):</p>
<table>
<tbody><tr>
<td>
<img src="./pics/27_The_Nyquist_Stability_Criterion_and_Relative_Stability_2.png" alt="27_The_Nyquist_Stability_Criterion_and_Relative_Stability_2" style="width:550px;">
</td>
</tr>
</tbody></table>
<section id="plotting-examples" class="level4">
<h4 class="anchored" data-anchor-id="plotting-examples">Plotting Examples</h4>
<p>Insert two Nyquist plots here: 1. A plot showing a response closer to the point (-1, j0), indicating a system closer to instability. 2. Another plot showing a response further from the point (-1, j0), indicating a more stable system.</p>
</section>
</section>
<section id="interpreting-nyquist-plots-for-relative-stability" class="level3">
<h3 class="anchored" data-anchor-id="interpreting-nyquist-plots-for-relative-stability">Interpreting Nyquist Plots for Relative Stability</h3>
<p>The Nyquist plot’s proximity to the point (-1, j0) gives us an indication of the system’s relative stability.</p>
<section id="absolute-vs.-relative-stability" class="level4">
<h4 class="anchored" data-anchor-id="absolute-vs.-relative-stability">Absolute vs.&nbsp;Relative Stability</h4>
<ul>
<li>Enclosing the point (-1, j0) indicates absolute stability.</li>
<li>The closer the plot is to this point, the higher the risk of instability.</li>
</ul>
</section>
<section id="observing-the-impact-of-gain-increase-through-the-polar-plot" class="level4">
<h4 class="anchored" data-anchor-id="observing-the-impact-of-gain-increase-through-the-polar-plot">Observing the Impact of Gain Increase through the Polar Plot</h4>
<ul>
<li><p>The polar plot is a graphical representation of a system’s frequency response, spanning from ω = 0 to ω = ∞.</p></li>
<li><p>The proximity of the polar plot to the critical point (-1, j0) is indicative of the system’s potential for sustained oscillations or instability.</p></li>
<li><p>Increasing the gain of the system tends to shift the polar plot closer to the critical point (-1, j0).</p></li>
<li><p>If this plot encircles the point (-1, j0), it is a signal that the system is moving towards instability.</p></li>
</ul>
<table>
<tbody><tr>
<td>
<img src="./pics/27_The_Nyquist_Stability_Criterion_and_Relative_Stability_3.png" alt="27_The_Nyquist_Stability_Criterion_and_Relative_Stability_3" style="width:550px;">
</td>
</tr>
</tbody></table>
</section>
<section id="assessing-relative-stability-using-the-polar-plot" class="level4">
<h4 class="anchored" data-anchor-id="assessing-relative-stability-using-the-polar-plot">Assessing Relative Stability Using the Polar Plot</h4>
<ul>
<li>The key to understanding a system’s relative stability lies in gauging the distance of the polar (or Nyquist) plot from the point (-1, j0).</li>
<li>Determining this “relative distance” involves measuring how close the plot is to (-1, j0), which in turn reflects the system’s susceptibility to instability.</li>
</ul>



<img src="./pics/27_The_Nyquist_Stability_Criterion_and_Relative_Stability_example_1.png" alt="27_The_Nyquist_Stability_Criterion_and_Relative_Stability_example_1" style="width:550px;">


<img src="./pics/27_The_Nyquist_Stability_Criterion_and_Relative_Stability_example_2.png" alt="27_The_Nyquist_Stability_Criterion_and_Relative_Stability_example_2" style="width:550px;">



</section>
<section id="the-importance-of-phase-angle" class="level4">
<h4 class="anchored" data-anchor-id="the-importance-of-phase-angle">The Importance of Phase Angle</h4>
<ul>
<li>Not only the intersection with the negative real axis but also the phase angle of the plot is critical in assessing relative stability.</li>
<li>Two indices are often used to measure this: the point of intersection on the real axis and the phase angle at the point where the magnitude is unity.</li>
</ul>



<img src="./pics/27_The_Nyquist_Stability_Criterion_and_Relative_Stability_example_3.png" alt="27_The_Nyquist_Stability_Criterion_and_Relative_Stability_example_3" style="width:550px;">



</section>
<section id="indices-for-measuring-relative-stability" class="level4">
<h4 class="anchored" data-anchor-id="indices-for-measuring-relative-stability">Indices for Measuring Relative Stability</h4>
<ol type="1">
<li><strong>Magnitude at Intersection</strong>: This is measured where the Nyquist plot intersects the negative real axis. The lower this magnitude, the more stable the system is considered.</li>
<li><strong>Phase Angle</strong>: A unit circle centered at (-1, j0) is considered. The angle at which this circle intersects the Nyquist plot provides a measure of relative stability.</li>
</ol>
<p>You can also say that these two indices are not necessarily enough. However, they provide a simple algorithm to quantify the relative stability.</p>
</section>
</section>
<section id="gain-and-phase-margins" class="level3">
<h3 class="anchored" data-anchor-id="gain-and-phase-margins">Gain and Phase Margins</h3>
<section id="gain-margin" class="level4">
<h4 class="anchored" data-anchor-id="gain-margin">Gain Margin</h4>
<p>Let’s delve into the scenario where the system’s gain, denoted as <span class="math inline">\(K\)</span>, is progressively increased. With this increment in gain, the overall magnitude of the Nyquist plot also rises. At a specific gain value, the plot intersects the critical point of (-1, j0).</p>
<p>To determine the precise gain increment required for the plot to intersect (-1, j0), we use the factor <span class="math inline">\(\frac{1}{a}\)</span>. Here, <span class="math inline">\(a\)</span> represents the distance of the plot’s intersection from the real axis in its original state (before gain increase).</p>
<p>By applying a gain of <span class="math inline">\(\frac{1}{a}\)</span> to your polar plot, you align its intersection with the real axis precisely at the -1 point.</p>
<p>The Gain Margin (GM) is mathematically expressed as <span class="math display">\[GM = \frac{1}{a}.\]</span> This value represents the threshold before the system reaches a state of marginal stability or instability.</p>
<p>The gain margin looks at the amplification factor at which a system becomes unstable.</p>
The following illustration depicts this concept visually:



<img src="./pics/27_The_Nyquist_Stability_Criterion_and_Relative_Stability_Gain_Margin.png" alt="27_The_Nyquist_Stability_Criterion_and_Relative_Stability_Gain_Margin" style="width:550px;">



</section>
<section id="phase-margin" class="level4">
<h4 class="anchored" data-anchor-id="phase-margin">Phase Margin</h4>
<p>To further clarify this concept, let’s examine a specific example:</p>
<p>Consider the transfer function:</p>
<p><span class="math display">\[
G(s) = K_1\frac{1 + sT_1}{s(1 + sT_2)}
\]</span></p>
<p>In this case, the number of open-loop poles in the right-half plane, denoted as <span class="math inline">\(P\)</span>, equals 0. This scenario corresponds to the Nyquist plot shown below:</p>



<img src="./pics/27_The_Nyquist_Stability_Criterion_and_Relative_Stability_Phase_Margin.png" alt="27_The_Nyquist_Stability_Criterion_and_Relative_Stability_Phase_Margin" style="width:550px;">



<p>Focusing on the phase margin, denoted as <span class="math inline">\(\phi\)</span>, we analyze its significance in system stability:</p>
<ul>
<li>The phase margin <span class="math inline">\(\phi\)</span> represents the additional phase lag that can be introduced into the system without causing it to intersect the critical point (-1, j0).</li>
<li>Essentially, it quantifies the system’s capacity to handle phase shifts without falling into instability.</li>
</ul>
<p>When considering the phase margin, a positive value of <span class="math inline">\(\phi\)</span> is indicative of the system’s robustness.</p>
<p>This positive phase margin is the threshold of additional phase lag that, if incorporated into the system, would lead it to the very edge of instability, yet not cross over into an unstable state.</p>
<p>The presence of a positive phase margin serves as a safeguard against instability, demonstrating the system’s ability to withstand certain levels of phase alterations.</p>
</section>
</section>
</section>
<section id="infinite-gain-margin" class="level2">
<h2 class="anchored" data-anchor-id="infinite-gain-margin">Infinite Gain Margin</h2>
<p>Consider a system where the Nyquist plot becomes asymptotic to a line but never intersects. In such cases, the gain margin is considered infinite.</p>
<p>Consider the transfer function:</p>
<p><span class="math display">\[
G(s) = \frac{K}{s(1 + sT)}
\]</span></p>
<p>This function has the following Polar plot, which never intersects the point -1. It asymptotically gets closer to the real axis for <span class="math inline">\(K\)</span> increasing.</p>



<img src="./pics/27_The_Nyquist_Stability_Criterion_and_Relative_Stability_Gain_Margin_Infinity.png" alt="27_The_Nyquist_Stability_Criterion_and_Relative_Stability_Gain_Margin_Infinity" style="width:550px;">


<img src="./pics/27_The_Nyquist_Stability_Criterion_and_Relative_Stability_Gain_Margin_Infinity_Phase_Margin_measure.png" alt="27_The_Nyquist_Stability_Criterion_and_Relative_Stability_Gain_Margin_Infinity_Phase_Margin_measure" style="width:550px;">



<p><strong>Implication:</strong></p>
<p>While it may sound ideal, an infinite gain margin often indicates other stability factors to consider, primarily the phase margin. The phase margin in this case is better suited to measure the distance to the -1 point, and it reduces when we increase <span class="math inline">\(K\)</span>.</p>
<section id="understanding-gain-and-phase-margins-in-open-loop-stable-systems" class="level3">
<h3 class="anchored" data-anchor-id="understanding-gain-and-phase-margins-in-open-loop-stable-systems">Understanding Gain and Phase Margins in Open-Loop Stable Systems</h3>
<p>It’s important to recognize that open-loop unstable systems fall outside the scope of the conventional definitions of gain and phase margins.</p>
<p>These margins are specifically designed and applicable for systems that exhibit stability in their open-loop configuration.</p>
<p>Consequently, the assessments of gain and phase margins are primarily relevant and meaningful when dealing with open-loop stable systems. In cases where the system is open-loop unstable, these definitions are not directly applicable, and alternative methods of stability analysis should be considered.</p>
<p>While the majority of industrial plants and control systems are inherently open-loop stable, it is crucial to exercise special caution when encountering an open-loop unstable system. This scenario, though less common, requires a more nuanced approach to ensure effective and safe plant operation. Understanding and addressing the unique challenges posed by open-loop unstable systems is essential for maintaining system stability and reliability.</p>
</section>
<section id="type-0-systems" class="level3">
<h3 class="anchored" data-anchor-id="type-0-systems">Type-0 Systems</h3>
<p>Let’s explore a specific example of a type-0 system, where the degrees of the numerator and denominator of the transfer function are equal.</p>
<ul>
<li><strong>Transfer Function:</strong></li>
</ul>
<p><span class="math display">\[
G(s)H(s) = \frac{1 + sT_1}{1 + sT_2}
\]</span></p>
<p>This is a type-0 system with the following Nyquist Plot:</p>
<p><span class="math display">\[
G(j\omega)H(j\omega) = \frac{1 + j\omega T_1}{1 +  j\omega T_2}
\]</span></p>
<ul>
<li><strong>Stability Analysis:</strong> The system is stable for all <span class="math inline">\(T_1\)</span> and <span class="math inline">\(T_2\)</span>. This makes the traditional definitions of gain and phase margin less meaningful.</li>
</ul>
<p>We can show this using Python:</p>
<div id="1a04b83a" class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> control <span class="im">as</span> ctl</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.cm <span class="im">as</span> cm</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the ranges for T1 and T2 values</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>T1_values <span class="op">=</span> np.linspace(<span class="fl">0.2</span>, <span class="dv">1</span>, <span class="dv">5</span>)  <span class="co"># Adjust the number of values as needed</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>T2_values <span class="op">=</span> np.linspace(<span class="fl">0.5</span>, <span class="fl">1.5</span>, <span class="dv">5</span>)  <span class="co"># Adjust the number of values as needed</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Prepare a colormap</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>num_plots <span class="op">=</span> <span class="bu">len</span>(T1_values) <span class="op">*</span> <span class="bu">len</span>(T2_values)</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>colors <span class="op">=</span> cm.viridis(np.linspace(<span class="dv">0</span>, <span class="dv">1</span>, num_plots))  <span class="co"># Use 'viridis' colormap</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Prepare the plot</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">8</span>))</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Nyquist Plots for Different T1 and T2 Values'</span>)</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Real Axis'</span>)</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Imaginary Axis'</span>)</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Iterate over combinations of T1 and T2</span></span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>color_idx <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> T1 <span class="kw">in</span> T1_values:</span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> T2 <span class="kw">in</span> T2_values:</span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>        num <span class="op">=</span> [<span class="dv">1</span>, T1]</span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a>        den <span class="op">=</span> [<span class="dv">1</span>, T2]</span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a>        G <span class="op">=</span> ctl.TransferFunction(num, den)</span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Extract real and imaginary parts</span></span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a>        _, contour <span class="op">=</span> ctl.nyquist(G, omega<span class="op">=</span>np.logspace(<span class="op">-</span><span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">1000</span>), return_contour<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a>        real, imag <span class="op">=</span> np.real(G(contour)), np.imag(G(contour))</span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Plot each curve with a label and the same color for mirror image</span></span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a>        color <span class="op">=</span> colors[color_idx]</span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a>        plt.plot(real, imag, label<span class="op">=</span><span class="ss">f'T1 = </span><span class="sc">{</span>T1<span class="sc">:.1f}</span><span class="ss">, T2 = </span><span class="sc">{</span>T2<span class="sc">:.1f}</span><span class="ss">'</span>, color<span class="op">=</span>color)</span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a>        plt.plot(real, <span class="op">-</span>imag, color<span class="op">=</span>color)  <span class="co"># Nyquist plot is symmetric</span></span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a>        color_idx <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-38"><a href="#cb1-38" aria-hidden="true" tabindex="-1"></a><span class="co"># Add legend, grid, and axis lines</span></span>
<span id="cb1-39"><a href="#cb1-39" aria-hidden="true" tabindex="-1"></a>plt.legend()</span>
<span id="cb1-40"><a href="#cb1-40" aria-hidden="true" tabindex="-1"></a>plt.grid(<span class="va">True</span>)</span>
<span id="cb1-41"><a href="#cb1-41" aria-hidden="true" tabindex="-1"></a>plt.axhline(y<span class="op">=</span><span class="dv">0</span>, color<span class="op">=</span><span class="st">'k'</span>)  <span class="co"># Add x-axis</span></span>
<span id="cb1-42"><a href="#cb1-42" aria-hidden="true" tabindex="-1"></a>plt.axvline(x<span class="op">=</span><span class="dv">0</span>, color<span class="op">=</span><span class="st">'k'</span>)  <span class="co"># Add y-axis</span></span>
<span id="cb1-43"><a href="#cb1-43" aria-hidden="true" tabindex="-1"></a>plt.xlim([<span class="op">-</span><span class="dv">2</span>, <span class="dv">2</span>])  <span class="co"># Adjust x-axis limits as needed</span></span>
<span id="cb1-44"><a href="#cb1-44" aria-hidden="true" tabindex="-1"></a>plt.ylim([<span class="op">-</span><span class="dv">2</span>, <span class="dv">2</span>])  <span class="co"># Adjust y-axis limits as needed</span></span>
<span id="cb1-45"><a href="#cb1-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-46"><a href="#cb1-46" aria-hidden="true" tabindex="-1"></a><span class="co"># Show the plot</span></span>
<span id="cb1-47"><a href="#cb1-47" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="27_The_Nyquist_Stability_Criterion_and_Relative_Stability_files/figure-html/cell-2-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="addressing-open-loop-unstable-systems" class="level2">
<h2 class="anchored" data-anchor-id="addressing-open-loop-unstable-systems">Addressing Open-Loop Unstable Systems</h2>
<p>When discussing gain margin and phase margin, their application in the context of open-loop unstable systems requires special attention.</p>
<section id="dealing-with-open-loop-unstable-systems" class="level4">
<h4 class="anchored" data-anchor-id="dealing-with-open-loop-unstable-systems">Dealing with Open-Loop Unstable Systems</h4>
<ul>
<li><strong>Characteristics:</strong> These are systems where one or more open-loop poles are located in the right-half of the s-plane.</li>
<li><strong>Relevance to Stability Margins:</strong> In such systems, the conventional interpretations of gain and phase margin are not straightforwardly applicable. A key aspect of these systems is that their Polar Plot needs to encircle the critical point (-1+j0) a specific number of times to achieve closed-loop stability.</li>
</ul>
</section>
<section id="an-illustrative-example" class="level4">
<h4 class="anchored" data-anchor-id="an-illustrative-example">An Illustrative Example</h4>
<ul>
<li><p><strong>Transfer Function:</strong> <span class="math display">\[
G(s)H(s) = \frac{s + \frac{1}{2}}{s(s + 1)(s - 1)}
\]</span> In this instance, the Nyquist plot must loop around the point (-1+j0) once to ensure stability.</p></li>
<li><p><strong>Additional Notes:</strong> For open-loop unstable systems, comprehensive Nyquist plots or alternative techniques such as root locus analysis are typically employed. The conventional stability margins of gain and phase are not typically used to evaluate the robustness of these systems, as they may not provide clear insights. In each case, a tailored approach is needed to account for the specific encirclements in the Nyquist plot.</p></li>
</ul>
<p>Below is a Python script to visualize its Nyquist Plot.</p>
<div id="5da4e7aa" class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> control <span class="im">as</span> ctl</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the numerator and denominator of the transfer function</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="co"># G(s)H(s) = (s + 0.5) / (s*(s + 1)*(s - 1))  </span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>num <span class="op">=</span> [<span class="dv">1</span>, <span class="fl">0.5</span>]</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>den <span class="op">=</span> [<span class="dv">1</span>, <span class="dv">0</span>, <span class="op">-</span><span class="dv">1</span>, <span class="dv">0</span>]</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the transfer function</span></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>G <span class="op">=</span> ctl.TransferFunction(num, den)</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute and plot the Nyquist plot</span></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>ctl.nyquist_plot(G)</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Nyquist Plot of G(s)H(s)'</span>)</span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Real Axis'</span>)</span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Imaginary Axis'</span>)</span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>plt.grid(<span class="va">True</span>)</span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Show the plot</span></span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="27_The_Nyquist_Stability_Criterion_and_Relative_Stability_files/figure-html/cell-3-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="understanding-crossover-frequencies" class="level2">
<h2 class="anchored" data-anchor-id="understanding-crossover-frequencies">Understanding Crossover Frequencies</h2>
<p>In control systems, two critical frequencies are the gain crossover frequency (<span class="math inline">\(\omega_{gc}\)</span>) and the phase crossover frequency (<span class="math inline">\(\omega_{pc}\)</span>).</p>
<p>These frequencies are important to determine the stability and performance of a system.</p>
<section id="gain-crossover-frequency-omega_gc" class="level4">
<h4 class="anchored" data-anchor-id="gain-crossover-frequency-omega_gc">Gain Crossover Frequency (<span class="math inline">\(\omega_{gc}\)</span>)</h4>
<ul>
<li><strong>Definition:</strong> The frequency at which the magnitude of the open-loop transfer function G(jω)H(jω) is 1 (0 dB).</li>
<li><strong>Importance:</strong> It is the frequency at which the system’s gain equals unity.</li>
<li><strong>Calculation:</strong> Determine <span class="math inline">\(\omega_{gc}\)</span> from the Nyquist or polar plot where |G(jω)H(jω)| = 1.</li>
</ul>
</section>
<section id="phase-crossover-frequency-omega_pc" class="level4">
<h4 class="anchored" data-anchor-id="phase-crossover-frequency-omega_pc">Phase Crossover Frequency (<span class="math inline">\(\omega_{pc}\)</span>)</h4>
<ul>
<li><strong>Definition:</strong> The frequency at which the phase angle of G(jω)H(jω) reaches -180°.</li>
<li><strong>Importance:</strong> It indicates the frequency at which the system’s phase shift might lead to instability.</li>
<li><strong>Calculation:</strong> Determine <span class="math inline">\(\omega_{pc}\)</span> from the Nyquist or polar plot where the phase angle of G(jω)H(jω) is -180°.er (<span class="math inline">\(\omega_{PC}\)</span>):** This is the frequency at which the phase angle of the system reaches -180 degrees.</li>
</ul>



<img src="./pics/27_The_Nyquist_Stability_Criterion_and_Relative_Stability_Gain_Margin_Infinity_Phase_Margin_recap.png" alt="27_The_Nyquist_Stability_Criterion_and_Relative_Stability_Gain_Margin_Infinity_Phase_Margin_recap" style="width:550px;">



</section>
<section id="clarifying-gain-and-phase-margins-in-control-systems" class="level3">
<h3 class="anchored" data-anchor-id="clarifying-gain-and-phase-margins-in-control-systems">Clarifying Gain and Phase Margins in Control Systems</h3>
<p>The gain margin, denoted as $ $, is a critical parameter in assessing a system’s stability. It’s important to understand that this margin is not directly the gain of the system itself. Instead, it becomes the gain only in the context of a system whose original plot is based on unity gain. In other cases, the gain margin represents the factor by which the system’s original gain can be modified.</p>
<section id="further-comments-on-the-gain-margin" class="level4">
<h4 class="anchored" data-anchor-id="further-comments-on-the-gain-margin">Further Comments on the Gain Margin</h4>
<ul>
<li>Assuming an Open-Loop Stable system (<span class="math inline">\(P=0\)</span>)</li>
<li>For a stable system, the gain margin is always greater than 1.</li>
<li>For an unstable system, the gain margin is less than 1.</li>
<li>If the gain margin is less than 1, it implies that the system’s gain has been increased to a level where instability has been introduced. To return the system to a stable state, the gain must be reduced by this margin factor.</li>
</ul>
</section>
<section id="further-comments-on-the-phase-margin" class="level4">
<h4 class="anchored" data-anchor-id="further-comments-on-the-phase-margin">Further Comments on the Phase Margin</h4>
<ul>
<li>The phase margin is determined by measuring a specific angle on the Nyquist plot. This angle represents the amount by which the phase can be increased without leading to instability.</li>
<li>In systems that are open-loop stable, a positive phase margin indicates a buffer against instability, whereas a negative phase margin is a sign of potential instability.</li>
<li>Assume to measure the phase margin angle with respect to the negative real axis.</li>
</ul>



<img src="./pics/27_The_Nyquist_Stability_Criterion_and_Relative_Stability_Gain_Margin_Infinity_Phase_Margin_recap_1.png" alt="27_The_Nyquist_Stability_Criterion_and_Relative_Stability_Gain_Margin_Infinity_Phase_Margin_recap_1" style="width:550px;">





</section>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/andreamunafo\.github\.io\/principles-of-automatic-controls");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




<footer class="footer"><div class="nav-footer"><div class="nav-footer-center"><div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/andreamunafo/principles-of-automatic-controls/issues/new" class="toc-action"><i class="bi bi-github"></i>Report an issue</a></li></ul></div></div></div></footer></body></html>